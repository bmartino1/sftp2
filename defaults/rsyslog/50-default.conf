# Ensure the /dev/log socket exists in slim containers
module(load="imuxsock" SysSock.Create="on")

# Traditional file format & sane defaults
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
$FileCreateMode 0640

# Auth logs (covers sshd/SFTP when SyslogFacility AUTHPRIV)
auth,authpriv.*                         -/var/log/auth.log

# Route sshd/SFTP to a dedicated file too (optional)
if ($programname == "sshd") then {
  action(type="omfile" file="/var/log/sftp.log" createpath="on" dirCreateMode="0755")
  stop
}

# Main syslog (exclude auth/authpriv to avoid duplication)
*.*;auth,authpriv.none                  -/var/log/syslog

# Kernel
kern.*                                  -/var/log/kern.log

# Cron
cron.*                                  -/var/log/cron.log

# Mail
mail.*                                  -/var/log/mail.log

# Emerg to console
*.=emerg                                :omusrmsg:*

# Also mirror everything to container stdout so `docker logs` works
*.*                                     action(type="omstdout")

